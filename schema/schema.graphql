type AllocationSlice {
  assetType: AssetType!
  totalValue: Decimal!
  percentage: Decimal!
}

type AssetGQL {
  id: ID!
  symbol: String!
  name: String!
  assetType: AssetType!
  quantity: Decimal!
  purchasePrice: Decimal!
  purchaseDate: Date!
  currentPrice: Decimal
  currency: String!
  notes: String
  totalCost: Decimal!
  currentValue: Decimal
  gainLoss: Decimal
  gainLossPercent: Decimal
  createdAt: DateTime!
  updatedAt: DateTime!
}

enum AssetType {
  STOCK
  CRYPTO
  FUND
  ETF
  BOND
  OTHER
}

type CategorySummary {
  category: CategoryType!
  totalAmount: Decimal!
  percentage: Decimal!
  transactionCount: Int!
}

type CategoryType {
  id: ID!
  name: String!
  color: String!
  icon: String
  createdAt: DateTime!
}

input CreateAssetInput {
  portfolioId: ID!
  symbol: String!
  name: String!
  assetType: AssetType!
  quantity: Decimal!
  purchasePrice: Decimal!
  purchaseDate: Date!
  currentPrice: Decimal = null
  currency: String! = "USD"
  notes: String = null
}

input CreateExpenseInput {
  amount: Decimal!
  description: String!
  date: Date!
  categoryId: ID!
  notes: String = null
  isRecurring: Boolean! = false
  recurrenceRule: RecurrenceRule = null
}

input CreatePortfolioInput {
  name: String!
  description: String = null
}

type DashboardSummary {
  totalExpensesThisMonth: Decimal!
  totalExpensesLastMonth: Decimal!
  expenseChangePercent: Decimal
  totalPortfolioValue: Decimal!
  totalPortfolioCost: Decimal!
  netWorth: Decimal!
  topCategories: [CategorySummary!]!
  recentExpenses: [ExpenseType!]!
  portfolioAllocation: [AllocationSlice!]!
  monthlyExpenseTrend: [MonthlyExpense!]!
}

"""Date (isoformat)"""
scalar Date

"""Date with time (isoformat)"""
scalar DateTime

"""Decimal (fixed-point)"""
scalar Decimal

type ExpenseConnection {
  items: [ExpenseType!]!
  totalCount: Int!
  hasMore: Boolean!
}

input ExpenseFilter {
  categoryId: ID = null
  startDate: Date = null
  endDate: Date = null
  minAmount: Decimal = null
  maxAmount: Decimal = null
  isRecurring: Boolean = null
  search: String = null
}

enum ExpenseSortField {
  DATE
  AMOUNT
}

type ExpenseType {
  id: ID!
  amount: Decimal!
  description: String!
  notes: String
  date: Date!
  category: CategoryType!
  isRecurring: Boolean!
  recurrenceRule: String
  createdAt: DateTime!
  updatedAt: DateTime!
}

type MonthlyExpense {
  month: String!
  totalAmount: Decimal!
}

type Mutation {
  createCategory(name: String!, color: String = null, icon: String = null): CategoryType!
  updateCategory(id: ID!, name: String = null, color: String = null, icon: String = null): CategoryType!
  deleteCategory(id: ID!): Boolean!
  createExpense(input: CreateExpenseInput!): ExpenseType!
  updateExpense(id: ID!, input: UpdateExpenseInput!): ExpenseType!
  deleteExpense(id: ID!): Boolean!
  createPortfolio(input: CreatePortfolioInput!): PortfolioType!
  updatePortfolio(id: ID!, input: UpdatePortfolioInput!): PortfolioType!
  deletePortfolio(id: ID!): Boolean!
  createAsset(input: CreateAssetInput!): AssetGQL!
  updateAsset(id: ID!, input: UpdateAssetInput!): AssetGQL!
  deleteAsset(id: ID!): Boolean!
  updateAssetPrice(id: ID!, currentPrice: Decimal!): AssetGQL!
}

type PortfolioType {
  id: ID!
  name: String!
  description: String
  assets: [AssetGQL!]!
  totalValue: Decimal!
  totalCost: Decimal!
  totalGainLoss: Decimal!
  totalGainLossPercent: Decimal!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type Query {
  health: String!
  categories: [CategoryType!]!
  category(id: ID!): CategoryType
  expenses(filter: ExpenseFilter = null, sortBy: ExpenseSortField! = DATE, sortDirection: SortDirection! = DESC, limit: Int! = 20, offset: Int! = 0): ExpenseConnection!
  expense(id: ID!): ExpenseType
  portfolios: [PortfolioType!]!
  portfolio(id: ID!): PortfolioType
  asset(id: ID!): AssetGQL
  dashboard(month: String = null): DashboardSummary!
}

enum RecurrenceRule {
  DAILY
  WEEKLY
  BIWEEKLY
  MONTHLY
  QUARTERLY
  YEARLY
}

enum SortDirection {
  ASC
  DESC
}

input UpdateAssetInput {
  symbol: String = null
  name: String = null
  assetType: AssetType = null
  quantity: Decimal = null
  purchasePrice: Decimal = null
  purchaseDate: Date = null
  currentPrice: Decimal = null
  currency: String = null
  notes: String = null
}

input UpdateExpenseInput {
  amount: Decimal = null
  description: String = null
  notes: String = null
  date: Date = null
  categoryId: ID = null
  isRecurring: Boolean = null
  recurrenceRule: RecurrenceRule = null
}

input UpdatePortfolioInput {
  name: String = null
  description: String = null
}
